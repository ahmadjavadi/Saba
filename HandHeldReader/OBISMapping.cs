using RsaDateTime;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace HandHeldReader
{
    public static class OBISMapping
    {
        static string[,] OBISMappingList =
        {               
            #region Nerw List Of Obismappint
            // 0: DlmsObis
            // 1 207 Obis
            // Convert Rule

            //{"0000010000FF","0.0.6","8"},  // ReadTime Or Meter Time   --  Merge With  0.0.7
            {"0000600100FF","0.0.0"," " },
            {"0802000001FF","0.0.1"," " },
            {"0100000002FF","0.0.2"," " },
            {"0000607000FF_0.0.3","0.0.3"," " },
            {"0000600101FF","0.0.4"," " },
            {"0100000402FF","0.0.5"," " },
            {"0000010000FF_0.0.6","0.0.6","7"},  // ReadTime Or Meter Time   --  Merge With  0.0.7
            {"0000010000FF_0.0.7","0.0.7","8"},  // ReadDate Or Meter Date   --  Merge With  0.0.6         
            {"0100608100FF","0.0.8"," " },
            {"01000F2E00FF","0.0.9"," " },
            {"00005E6200FF","0.1.0"," " },
            {"000063620366_0.1.1","0.1.1"," " },
            {"000063620367_0.1.2","0.1.2"," " },
            {"000063620368_0.1.3","0.1.3"," " },
            {"000063620369_0.1.4","0.1.4"," " },
            {"00006362036A_0.1.5","0.1.5"," " },
            {"00006362036B_0.1.6","0.1.6"," " },
            {"00006362036C_0.1.7","0.1.7"," " },
            {"00006362036D_0.1.8","0.1.8"," " },
            {"00006362036E_0.1.9","0.1.9"," " }, // کد نصاب شماره 9
            {"000063620365","0.3.0","8"},  // Convert To Georgian DateTime
            {"000063620366_0.3.1","0.3.1","8"},  // Convert To Georgian DateTime
            {"000063620367_0.3.2","0.3.2","8"},  // Convert To Georgian DateTime
            {"000063620368_0.3.3","0.3.3","8"},  // Convert To Georgian DateTime
            {"000063620369_0.3.4","0.3.4","8"},  // Convert To Georgian DateTime
            {"00006362036A_0.3.5","0.3.5","8"},  // Convert To Georgian DateTime
            {"00006362036B_0.3.6","0.3.6","8"},  // Convert To Georgian DateTime
            {"00006362036C_0.3.7","0.3.7","8"},  // Convert To Georgian DateTime
            {"00006362036D_0.3.8","0.3.8","8"},  // Convert To Georgian DateTime
            {"00006362036E_0.3.9","0.3.9","8"},  // Convert To Georgian DateTime
            {"0000603E03FF","1.0.0","1"},  //m3 *1000
            {"0000603E01FF","1.0.1","1"},  //m3 *1000
            {"0000603E05FF","1.0.2","8"},  // Convert To Georgian DateTime
            {"0000603D02FF","1.0.3","8"},  // Convert To Georgian DateTime
            {"0802606101FF","1.0.4"," " },
            {"00000C0000FF_1.0.5","1.0.5","8"},  // Convert To Georgian DateTime
            {"00000C0000FF_1.0.6","1.0.6","8"},
            {"00000C0000FF_1.0.7","1.0.7"," " },
            {"00000C0000FF_1.0.8","1.0.8"," " },
            {"00000C0000FF_1.0.9","1.0.9"," " },
            {"00000C0000FF_1.0.A","1.0.A","8"},  // Convert To Georgian DateTime
            {"00000C0000FF_1.0.B","1.0.B","8"},  // Convert To Georgian DateTime
            {"00000C0000FF_1.0.C","1.0.C"," " },
            {"00000C0000FF_1.0.D","1.0.D"," " },
            {"0802802800FF_2.0.0","2.0.0"," " },
            {"0802802800FF_2.0.1","2.0.1","2"},  //KW *1000
            {"0802802800FF_2.0.2","2.0.2","3"},  //mLit/s *1000
            {"0802802800FF_2.0.3","2.0.3","2"},  //KW *1000
            {"010062010065","2.0.4","8"},  // Convert To Georgian DateTime
            {"0100620100FF","2.0.5"," " },
            {"0802802800FF_2.1.0","2.1.0","3"},  //mLit/s *1000
            {"0802802800FF_2.1.1","2.1.1","3"},  //mLit/s *1000
            {"0802802800FF_2.1.2","2.1.2","3"},  //mLit/s *1000
            {"0802802800FF_2.1.3","2.1.3","3"},  //mLit/s *1000
            {"0802802800FF_2.1.4","2.1.4","3"},  //mLit/s *1000
            {"0802802800FF_2.1.5","2.1.5","3"},  //mLit/s *1000
            {"0802802800FF_2.2.0","2.2.0","2"},  //KW *1000
            {"0802802800FF_2.2.1","2.2.1","2"},  //KW *1000
            {"0802802800FF_2.2.2","2.2.2","2"},  //KW *1000
            {"0802802800FF_2.2.3","2.2.3","2"},  //KW *1000
            {"0802802800FF_2.2.4","2.2.4","2"},  //KW *1000
            {"0802802800FF_2.2.5","2.2.5","2"},  //KW *1000

            {"0802606200FF","3.0.0","9"},  // Convert Hour Time To Hour.Minutes
            {"0802010000FF","3.0.1","1"},  //m3 *1000
            {"0802010100FF","3.1.0","1"},  //m3 *1000
            {"080201010065","3.1.1","1"},  //m3 *1000    آب مصرفی ماه 1
            {"080201010066","3.1.2","1"},  //m3 *1000
            {"080201010067","3.1.3","1"},  //m3 *1000
            {"080201010068","3.1.4","1"},  //m3 *1000
            {"080201010069","3.1.5","1"},  //m3 *1000
            
            {"08020101006A","3.2.0","1"},  //m3 *1000
            {"08020101006B","3.2.1","1"},  //m3 *1000
            {"08020101006C","3.2.2","1"},  //m3 *1000
            {"08020101006D","3.2.3","1"},  //m3 *1000
            {"08020101006E","3.2.4","1"},  //m3 *1000
            {"08020101006F","3.2.5","1"},  //m3 *1000
            
            {"080201010070","3.3.0","1"},  //m3 *1000
            {"080201010071","3.3.1","1"},  //m3 *1000
            {"080201010072","3.3.2","1"},  //m3 *1000
            {"080201010073","3.3.3","1"},  //m3 *1000
            {"080201010074","3.3.4","1"},  //m3 *1000
            {"080201010075","3.3.5","1"},  //m3 *1000
            
            {"080201010076","3.4.0","1"},  //m3 *1000
            {"080201010077","3.4.1","1"},  //m3 *1000
            {"080201010078","3.4.2","1"},  //m3 *1000
            {"080201010079","3.4.3","1"},  //m3 *1000
            {"08020101007A","3.4.4","1"},  //m3 *1000
            {"08020101007B","3.4.5","1"},  //m3 *1000            

            {"0802020000FF","4.0.0","3"},  //mLit/s *1000
            {"0802020500FF","4.0.1","3"},  //mLit/s *1000
            {"080202050065","4.0.2","3"},  //mLit/s *1000
            {"080202050066","4.0.3","3"},  //mLit/s *1000
            {"080202050067","4.0.4","3"},  //mLit/s *1000  
          
            {"080202050068","4.1.0","3"},  //mLit/s *1000
            {"080202050069","4.1.1","3"},  //mLit/s *1000
            {"08020205006A","4.1.2","3"},  //mLit/s *1000
            {"08020205006B","4.1.3","3"},  //mLit/s *1000
            {"08020205006C","4.1.4","3"},  //mLit/s *1000

            {"08020205006D","4.2.0","3"},  //mLit/s *1000
            {"08020205006E","4.2.1","3"},  //mLit/s *1000
            {"08020205006F","4.2.2","3"},  //mLit/s *1000
            {"080202050070","4.2.3","3"},  //mLit/s *1000
            {"080202050071","4.2.4","3"},  //mLit/s *1000

            {"080202050072","4.3.0","3"},  //mLit/s *1000
            {"080202050073","4.3.1","3"},  //mLit/s *1000
            {"080202050074","4.3.2","3"},  //mLit/s *1000
            {"080202050075","4.3.3","3"},  //mLit/s *1000
            {"080202050076","4.3.4","3"},  //mLit/s *1000

            {"080202050077","4.4.0","3"},  //mLit/s *1000
            {"080202050078","4.4.1","3"},  //mLit/s *1000
            {"080202050079","4.4.2","3"},  //mLit/s *1000
            {"08020205007A","4.4.3","3"},  //mLit/s *1000
            {"08020205007B","4.4.4","3"},  //mLit/s *1000

            {"01000F0800FF","5.0.0","6"},  //kWh *1000
            {"01000F0801FF","5.0.1","6"},  //kWh *1000
            {"01000F0802FF","5.0.2","6"},  //kWh *1000
            {"01000F0803FF","5.0.3","6"},  //kWh *1000
            {"01000F0804FF","5.0.4","6"},  //kWh *1000
            {"01000F0200FF","5.1.0","2"},  //kw *1000
            {"01000F0805FF","5.1.1","6"},  //kWh *1000
            {"01000F0806FF","5.1.2","6"},  //kWh *1000
            {"01000F0807FF","5.1.3","6"},  //kWh *1000
            {"01000F0808FF","5.1.4","6"},  //kWh *1000
            {"01000F080065","5.2.0","6"},  //kWh *1000
            {"01000F080165","5.2.1","6"},  //kWh *1000
            {"01000F080265","5.2.2","6"},  //kWh *1000
            {"01000F080365","5.2.3","6"},  //kWh *1000
            {"01000F080465","5.2.4","6"},  //kWh *1000
            {"01000F080565","5.3.1","6"},  //kWh *1000
            {"01000F080665","5.3.2","6"},  //kWh *1000
            {"01000F080765","5.3.3","6"},  //kWh *1000
            {"01000F080865","5.3.4","6"},  //kWh *1000
            {"01000F080066","5.4.0","6"},  //kWh *1000
            {"01000F080166","5.4.1","6"},  //kWh *1000
            {"01000F080266","5.4.2","6"},  //kWh *1000
            {"01000F080366","5.4.3","6"},  //kWh *1000
            {"01000F080466","5.4.4","6"},  //kWh *1000
            {"01000F080566","5.5.1","6"},  //kWh *1000
            {"01000F080666","5.5.2","6"},  //kWh *1000
            {"01000F080766","5.5.3","6"},  //kWh *1000
            {"01000F080866","5.5.4","6"},  //kWh *1000
            {"01000F080067","5.6.0","6"},  //kWh *1000
            {"01000F080167","5.6.1","6"},  //kWh *1000
            {"01000F080267","5.6.2","6"},  //kWh *1000
            {"01000F080367","5.6.3","6"},  //kWh *1000
            {"01000F080467","5.6.4","6"},  //kWh *1000
            {"01000F080567","5.7.1","6"},  //kWh *1000
            {"01000F080667","5.7.2","6"},  //kWh *1000
            {"01000F080767","5.7.3","6"},  //kWh *1000
            {"01000F080867","5.7.4","6"},  //kWh *1000
            {"01000F080068","5.8.0","6"},  //kWh *1000
            {"01000F080168","5.8.1","6"},  //kWh *1000
            {"01000F080268","5.8.2","6"},  //kWh *1000
            {"01000F080368","5.8.3","6"},  //kWh *1000
            {"01000F080468","5.8.4","6"},  //kWh *1000
            {"01000F080568","5.9.1","6"},  //kWh *1000
            {"01000F080668","5.9.2","6"},  //kWh *1000
            {"01000F080768","5.9.3","6"},  //kWh *1000
            {"01000F080868","5.9.4","6"},  //kWh *1000
            {"01000F080069","5.A.0","6"},  //kWh *1000
            {"01000F080169","5.A.1","6"},  //kWh *1000
            {"01000F080269","5.A.2","6"},  //kWh *1000
            {"01000F080369","5.A.3","6"},  //kWh *1000
            {"01000F080469","5.A.4","6"},  //kWh *1000
            {"01000F080569","5.B.1","6"},  //kWh *1000
            {"01000F080669","5.B.2","6"},  //kWh *1000
            {"01000F080769","5.B.3","6"},  //kWh *1000
            {"01000F080869","5.B.4","6"},  //kWh *1000
            {"01000F08006A","5.C.0","6"},  //kWh *1000
            {"01000F08016A","5.C.1","6"},  //kWh *1000
            {"01000F08026A","5.C.2","6"},  //kWh *1000
            {"01000F08036A","5.C.3","6"},  //kWh *1000
            {"01000F08046A","5.C.4","6"},  //kWh *1000
            {"01000F08056A","5.D.1","6"},  //kWh *1000
            {"01000F08066A","5.D.2","6"},  //kWh *1000
            {"01000F08076A","5.D.3","6"},  //kWh *1000
            {"01000F08086A","5.D.4","6"},  //kWh *1000
            {"0100030800FF","6.0.0","5"},  //kvarh *1000
            {"010003080065","6.0.1","5"},  //kvarh *1000
            {"010003080066","6.0.2","5"},  //kvarh *1000
            {"010003080067","6.0.3","5"},  //kvarh *1000
            {"010003080068","6.0.4","5"},  //kvarh *1000
            {"010003080069","6.0.5","5"},  //kvarh *1000
            {"01000308006A","6.0.6","5"},  //kvarh *1000
            {"0000603300FF","6.0.7","9"},  // Convert Hour Time To Hour.Minutes
            {"0000600700FF","6.0.8"," " },
            {"0100040800FF","6.1.0","5"},  //kvarh *1000
            {"010004080065","6.1.1","5"},  //kvarh *1000
            {"010004080066","6.1.2","5"},  //kvarh *1000
            {"010004080067","6.1.3","5"},  //kvarh *1000
            {"010004080068","6.1.4","5"},  //kvarh *1000
            {"010004080069","6.1.5","5"},  //kvarh *1000
            {"01000408006A","6.1.6","5"},  //kvarh *1000
            {"0100030700FF","7.0.1","5"},  //kvarh *1000
            {"01000F0700FF","7.0.2","2"},  //KW *1000
            {"0100012E00FF","8.0.0","2"},  //KW *1000
            {"0100010400FF09","8.0.1"," " },
            {"0100012400FF","8.0.2"," " },
            {"010001240065","8.0.3"," " },
            {"010001240066","8.0.4"," " },
            {"010001240067","8.0.5"," " },
            {"010001240068","8.0.6"," " },
            {"010001240069","8.0.7"," " },
            {"01000124006A","8.0.8"," " },
            {"0100010400FF02","8.0.9","2"},  //KW *1000
            {"0100000804FF","8.0.A"," " },
            {"0000150001FF_8.0.C","8.0.C"," " },
            {"0000150001FF_8.0.D","8.0.D"," " },
            {"01000F0600FF","8.1.0","2"},  //KW *1000
            {"01000F0601FF","8.1.1","2"},  //KW *1000
            {"01000F0602FF","8.1.2","2"},  //KW *1000
            {"01000F0603FF","8.1.3","2"},  //KW *1000
            {"01000F0604FF","8.1.4","2"},  //KW *1000
            {"01000F0605FF","8.1.5","2"},  //KW *1000
            {"01000F0606FF","8.1.6","2"},  //KW *1000
            {"01000F0607FF","8.1.7","2"},  //KW *1000
            {"01000F0608FF","8.1.8","2"},  //KW *1000

            #region   // Invalid Unit In 207 HHU ; Unit Of bellow Obis is KW but HHU save them with KWH,""," ",
            {"01000F060065","8.2.0","6"},  //KW *1000
            {"01000F060165","8.2.1","6"},  //KW *1000
            {"01000F060265","8.2.2","6"},  //KW *1000
            {"01000F060365","8.2.3","6"},  //KW *1000
            {"01000F060465","8.2.4","6"},  //KW *1000
            {"01000F060565","8.2.5","6"},  //KW *1000
            {"01000F060665","8.2.6","6"},  //KW *1000
            {"01000F060765","8.2.7","6"},  //KW *1000
            {"01000F060865","8.2.8","6"},  //KW *1000
            {"01000F060066","8.3.0","6"},  //KW *1000
            {"01000F060166","8.3.1","6"},  //KW *1000
            {"01000F060266","8.3.2","6"},  //KW *1000
            {"01000F060366","8.3.3","6"},  //KW *1000
            {"01000F060466","8.3.4","6"},  //KW *1000
            {"01000F060566","8.3.5","6"},  //KW *1000
            {"01000F060666","8.3.6","6"},  //KW *1000
            {"01000F060766","8.3.7","6"},  //KW *1000
            {"01000F060866","8.3.8","6"},  //KW *1000
            {"01000F060067","8.4.0","6"},  //KW *1000
            {"01000F060167","8.4.1","6"},  //KW *1000
            {"01000F060267","8.4.2","6"},  //KW *1000
            {"01000F060367","8.4.3","6"},  //KW *1000
            {"01000F060467","8.4.4","6"},  //KW *1000
            {"01000F060567","8.4.5","6"},  //KW *1000
            {"01000F060667","8.4.6","6"},  //KW *1000
            {"01000F060767","8.4.7","6"},  //KW *1000
            {"01000F060867","8.4.8","6"},  //KW *1000
            {"01000F060068","8.5.0","6"},  //KW *1000
            {"01000F060168","8.5.1","6"},  //KW *1000
            {"01000F060268","8.5.2","6"},  //KW *1000
            {"01000F060368","8.5.3","6"},  //KW *1000
            {"01000F060468","8.5.4","6"},  //KW *1000
            {"01000F060568","8.5.5","6"},  //KW *1000
            {"01000F060668","8.5.6","6"},  //KW *1000
            {"01000F060768","8.5.7","6"},  //KW *1000
            {"01000F060868","8.5.8","6"},  //KW *1000
            {"01000F060069","8.6.0","6"},  //KW *1000
            {"01000F060169","8.6.1","6"},  //KW *1000
            {"01000F060269","8.6.2","6"},  //KW *1000
            {"01000F060369","8.6.3","6"},  //KW *1000
            {"01000F060469","8.6.4","6"},  //KW *1000
            {"01000F060569","8.6.5","6"},  //KW *1000
            {"01000F060669","8.6.6","6"},  //KW *1000
            {"01000F060769","8.6.7","6"},  //KW *1000
            {"01000F060869","8.6.8","6"},  //KW *1000
            {"01000F06006A","8.7.0","6"},  //KW *1000
            {"01000F06016A","8.7.1","6"},  //KW *1000
            {"01000F06026A","8.7.2","6"},  //KW *1000
            {"01000F06036A","8.7.3","6"},  //KW *1000
            {"01000F06046A","8.7.4","6"},  //KW *1000
            {"01000F06056A","8.7.5","6"},  //KW *1000
            {"01000F06066A","8.7.6","6"},  //KW *1000
            {"01000F06076A","8.7.7","6"},  //KW *1000
            {"01000F06086A","8.7.8","6"},  //KW *1000
            #endregion

            {"00000D0000FF_9.0.0","9.0.0"," " },
            {"00000D0000FF_9.0.1","9.0.1"," " },
            {"00000D0000FF_9.0.2","9.0.2"," " },
            {"00000D0000FF_9.0.3","9.0.3"," " },
            {"00000D0000FF_9.0.4","9.0.4"," " },
            {"00000D0000FF_9.0.5","9.0.5"," " },
            {"00000D0000FF_9.0.6","9.0.6"," " },
            {"00000D0000FF_9.0.7","9.0.7"," " },
            {"00000D0000FF_9.0.8","9.0.8"," " },
            {"00000D0000FF_9.1.0","9.1.0"," " },
            {"00000D0000FF_9.1.1","9.1.1"," " },
            {"00000D0000FF_9.1.2","9.1.2"," " },
            {"00000D0000FF_9.1.3","9.1.3"," " },
            {"00000D0000FF_9.1.4","9.1.4"," " },
            {"00000D0000FF_9.1.5","9.1.5"," " },
            {"00000D0000FF_9.1.6","9.1.6"," " },
            {"00000D0000FF_9.1.7","9.1.7"," " },
            {"00000D0000FF_9.1.8","9.1.8"," " },
            {"00000D0000FF_9.2.0","9.2.0"," " },
            {"00000D0000FF_9.2.1","9.2.1"," " },
            {"00000D0000FF_9.2.2","9.2.2"," " },
            {"00000D0000FF_9.2.3","9.2.3"," " },
            {"00000D0000FF_9.2.4","9.2.4"," " },
            {"00000D0000FF_9.2.5","9.2.5"," " },
            {"00000D0000FF_9.2.6","9.2.6"," " },
            {"00000D0000FF_9.2.7","9.2.7"," " },
            {"00000D0000FF_9.2.8","9.2.8"," " },
            {"00000D0000FF_9.3.0","9.3.0"," " },
            {"00000D0000FF_9.3.1","9.3.1"," " },
            {"00000D0000FF_9.3.2","9.3.2"," " },
            {"00000D0000FF_9.3.3","9.3.3"," " },
            {"00000D0000FF_9.3.4","9.3.4"," " },
            {"00000D0000FF_9.3.5","9.3.5"," " },
            {"00000D0000FF_9.3.6","9.3.6"," " },
            {"00000D0000FF_9.3.7","9.3.7"," " },
            {"00000D0000FF_9.3.8","9.3.8"," " },
            {"00000D0000FF_9.4.1","9.4.1"," " },
            {"00000D0000FF_9.4.2","9.4.2"," " },
            {"00000D0000FF_9.4.3","9.4.3"," " },
            {"00000D0000FF_9.4.4","9.4.4"," " },
            {"00000D0000FF_9.4.5","9.4.5"," " },
            {"00000D0000FF_9.4.6","9.4.6"," " },
            {"00000D0000FF_9.4.7","9.4.7"," " },
            {"00000D0000FF_9.4.8","9.4.8"," " },
            {"00000D0000FF_9.5.1","9.5.1"," " },
            {"00000D0000FF_9.5.2","9.5.2"," " },
            {"00000D0000FF_9.5.3","9.5.3"," " },
            {"00000D0000FF_9.5.4","9.5.4"," " },
            {"00000D0000FF_9.5.5","9.5.5"," " },
            {"00000D0000FF_9.5.6","9.5.6"," " },
            {"00000D0000FF_9.5.7","9.5.7"," " },
            {"00000D0000FF_9.5.8","9.5.8"," " },
            {"00000D0000FF_9.6.1","9.6.1"," " },
            {"00000D0000FF_9.6.2","9.6.2"," " },
            {"00000D0000FF_9.6.3","9.6.3"," " },
            {"00000D0000FF_9.6.4","9.6.4"," " },
            {"00000D0000FF_9.6.5","9.6.5"," " },
            {"00000D0000FF_9.6.6","9.6.6"," " },
            {"00000D0000FF_9.6.7","9.6.7"," " },
            {"00000D0000FF_9.6.8","9.6.8"," " },
            {"00000D0000FF_9.7.1","9.7.1"," " },
            {"00000D0000FF_9.7.2","9.7.2"," " },
            {"00000D0000FF_9.7.3","9.7.3"," " },
            {"00000D0000FF_9.7.4","9.7.4"," " },
            {"00000D0000FF_9.7.5","9.7.5"," " },
            {"00000D0000FF_9.7.6","9.7.6"," " },
            {"00000D0000FF_9.7.7","9.7.7"," " },
            {"00000D0000FF_9.7.8","9.7.8"," " },
            {"00000B0000FF_A.0.2","A.0.2"," " },
            {"00000D0000FF_A.0.3","A.0.3"," " },
            {"00000D0000FF_A.0.4","A.0.4"," " },
            {"00000B0000FF_A.1.0","A.1.0"," " },
            {"00000B0000FF_A.1.1","A.1.1"," " },
            {"00000B0000FF_A.1.2","A.1.2"," " },
            {"00000B0000FF_A.1.3","A.1.3"," " },
            {"00000B0000FF_A.1.4","A.1.4"," " },
            {"00000B0000FF_A.2.0","A.2.0"," " },
            {"00000B0000FF_A.2.1","A.2.1"," " },
            {"00000B0000FF_A.2.2","A.2.2"," " },
            {"00000B0000FF_A.2.3","A.2.3"," " },
            {"00000B0000FF_A.2.4","A.2.4"," " },
            {"00000B0000FF_A.3.0","A.3.0"," " },
            {"00000B0000FF_A.3.1","A.3.1"," " },
            {"00000B0000FF_A.3.2","A.3.2"," " },
            {"00000B0000FF_A.3.3","A.3.3"," " },
            {"00000B0000FF_A.3.4","A.3.4"," " },
            {"00000B0000FF_A.4.0","A.4.0"," " },
            {"00000B0000FF_A.4.1","A.4.1"," " },
            {"00000B0000FF_A.4.2","A.4.2"," " },
            {"00000B0000FF_A.4.3","A.4.3"," " },
            {"00000B0000FF_A.4.4","A.4.4"," " },
            {"00000B0000FF_A.5.0","A.5.0"," " },
            {"00000B0000FF_A.5.1","A.5.1"," " },
            {"00000B0000FF_A.5.2","A.5.2"," " },
            {"00000B0000FF_A.5.3","A.5.3"," " },
            {"00000B0000FF_A.5.4","A.5.4"," " },
            {"00000B0000FF_A.6.0","A.6.0"," " },
            {"00000B0000FF_A.6.1","A.6.1"," " },
            {"00000B0000FF_A.6.2","A.6.2"," " },
            {"00000B0000FF_A.6.3","A.6.3"," " },
            {"00000B0000FF_A.6.4","A.6.4"," " },
            {"00000B0000FF_A.7.0","A.7.0"," " },
            {"00000B0000FF_A.7.1","A.7.1"," " },
            {"00000B0000FF_A.7.2","A.7.2"," " },
            {"00000B0000FF_A.7.3","A.7.3"," " },
            {"00000B0000FF_A.7.4","A.7.4"," " },
            {"00000B0000FF_A.8.0","A.8.0"," " },
            {"00000B0000FF_A.8.1","A.8.1"," " },
            {"00000B0000FF_A.8.2","A.8.2"," " },
            {"00000B0000FF_A.8.3","A.8.3"," " },
            {"00000B0000FF_A.8.4","A.8.4"," " },
            {"0000150001FF_A.9.1","A.9.1"," " },
            {"0000150001FF_A.9.2","A.9.2"," " },
            {"0100000200FF","A.9.3"," " },
            {"0000607000FF_B.0.1","B.0.1"," " },
            {"0000810000FF_B.0.2","B.0.2"," " },
            {"0000810000FF_B.0.3","B.0.3"," " },
            {"0100630100FF","C.0.0"," " }
       

            #endregion   

        };

        static string[,] fixed_OBIS =
        {          
            #region fixed_OBIS
            {"0.2.0","500"},
            {"0.2.1","500"},
            {"0.2.2","500"},
            {"0.2.3","500"},
            {"0.2.4","500"},
            {"0.2.5","500"},
            {"0.2.6","500"},
            {"0.2.7","500"},
            {"0.2.8","500"},
            {"0.2.9","500"},
            {"0000010000FF","500"},
            {"00000C0000FF_1.0.5","500"},
            {"00000C0000FF_1.0.6","500"},
            {"00000C0000FF_1.0.A","500"},
            {"00000C0000FF_1.0.B","500"},
            {"000060070AFF","500"},
            {"0000603D02FF","500"},
            {"0000603D03FF","500"},
            {"0000603E05FF","500"},
            {"000063620365","500"},
            {"000063620366","500"},
            {"000063620367","500"},
            {"000063620368","500"},
            {"000063620369","500"},
            {"00006362036A","500"},
            {"00006362036B","500"},
            {"00006362036C","500"},
            {"00006362036D","500"},
            {"00006362036E","500"},
            {"010000F060169","906"},
            {"010001240065","901"},
            {"010001240066","902"},
            {"010001240067","903"},
            {"010001240068","904"},
            {"010001240069","905"},
            {"01000124006A","906"},
            {"010003080065","901"},
            {"010003080066","902"},
            {"010003080067","903"},
            {"010003080068","904"},
            {"010003080069","905"},
            {"01000308006A","906"},
            {"010004080065","901"},
            {"010004080066","902"},
            {"010004080067","903"},
            {"010004080068","904"},
            {"010004080069","905"},
            {"01000408006A","906"},
            {"01000F0200FF","900"},
            {"01000F060066","902"},
            {"01000F060067","903"},
            {"01000F060068","904"},
            {"01000F060069","905"},
            {"01000F06006A","906"},
            {"01000F060165","901"},
            {"01000F060166","902"},
            {"01000F060167","903"},
            {"01000F060168","904"},
            {"01000F060169","905"},
            {"01000F060265","901"},
            {"01000F060266","902"},
            {"01000F060267","903"},
            {"01000F060268","904"},
            {"01000F060269","905"},
            {"01000F06026A","906"},
            {"01000F060365","901"},
            {"01000F060366","902"},
            {"01000F060367","903"},
            {"01000F060368","904"},
            {"01000F060369","905"},
            {"01000F06036A","906"},
            {"01000F060465","901"},
            {"01000F060466","902"},
            {"01000F060467","903"},
            {"01000F060468","904"},
            {"01000F060469","905"},
            {"01000F06046A","906"},
            {"01000F060565","901"},
            {"01000F060566","902"},
            {"01000F060567","903"},
            {"01000F060568","904"},
            {"01000F060569","905"},
            {"01000F06056A","906"},
            {"01000F060665","901"},
            {"01000F060666","902"},
            {"01000F060667","903"},
            {"01000F060668","904"},
            {"01000F060669","905"},
            {"01000F06066A","906"},
            {"01000F060765","901"},
            {"01000F060766","902"},
            {"01000F060767","903"},
            {"01000F060768","904"},
            {"01000F060769","905"},
            {"01000F06076A","906"},
            {"01000F060865","901"},
            {"01000F060866","902"},
            {"01000F060867","903"},
            {"01000F060868","904"},
            {"01000F060869","905"},
            {"01000F06086A","906"},
            {"01000F080065","901"},
            {"01000F080066","902"},
            {"01000F080067","903"},
            {"01000F080068","904"},
            {"01000F080069","905"},
            {"01000F08006A","906"},
            {"01000F0800FF","900"},
            {"01000F080165","901"},
            {"01000F080166","902"},
            {"01000F080167","903"},
            {"01000F080168","904"},
            {"01000F080169","905"},
            {"01000F08016A","906"},
            {"01000F0801FF","900"},
            {"01000F080265","901"},
            {"01000F080266","902"},
            {"01000F080267","903"},
            {"01000F080268","904"},
            {"01000F080269","905"},
            {"01000F08026A","906"},
            {"01000F0802FF","900"},
            {"01000F080365","901"},
            {"01000F080366","902"},
            {"01000F080367","903"},
            {"01000F080368","904"},
            {"01000F080369","905"},
            {"01000F08036A","906"},
            {"01000F0803FF","900"},
            {"01000F080465","901"},
            {"01000F080466","902"},
            {"01000F080467","903"},
            {"01000F080468","904"},
            {"01000F080469","905"},
            {"01000F08046A","906"},
            {"01000F0804FF","900"},
            {"01000F080565","901"},
            {"01000F080566","902"},
            {"01000F080567","903"},
            {"01000F080568","904"},
            {"01000F080569","905"},
            {"01000F08056A","906"},
            {"01000F0805FF","900"},
            {"01000F080665","901"},
            {"01000F080666","902"},
            {"01000F080667","903"},
            {"01000F080668","904"},
            {"01000F080669","905"},
            {"01000F08066A","906"},
            {"01000F0806FF","900"},
            {"01000F080765","901"},
            {"01000F080766","902"},
            {"01000F080767","903"},
            {"01000F080768","904"},
            {"01000F080769","905"},
            {"01000F08076A","906"},
            {"01000F0807FF","900"},
            {"01000F080865","901"},
            {"01000F080866","902"},
            {"01000F080867","903"},
            {"01000F080868","904"},
            {"01000F080869","905"},
            {"01000F08086A","906"},
            {"01000F0808FF","900"},
            {"010062010065","500"},
            {"080201000065","801"},
            {"080201000066","802"},
            {"080201000067","803"},
            {"080201000068","804"},
            {"080201000069","805"},
            {"08020100006A","806"},
            {"08020100006B","807"},
            {"08020100006C","808"},
            {"08020100006D","809"},
            {"08020100006E","810"},
            {"08020100006F","811"},
            {"080201000070","812"},
            {"080201000071","813"},
            {"080201000072","814"},
            {"080201000073","815"},
            {"080201000074","816"},
            {"080201000075","817"},
            {"080201000076","818"},
            {"080201000077","819"},
            {"080201000078","820"},
            {"080201000079","821"},
            {"08020100007A","822"},
            {"08020100007B","823"},
            {"08020100007C","823"},
            {"0802010000FF","800"},
            {"080201010065","801"},
            {"080201010066","802"},
            {"080201010067","803"},
            {"080201010068","804"},
            {"080201010069","805"},
            {"08020101006A","806"},
            {"08020101006B","807"},
            {"08020101006C","808"},
            {"08020101006D","809"},
            {"08020101006E","810"},
            {"08020101006F","811"},
            {"080201010070","812"},
            {"080201010071","813"},
            {"080201010072","814"},
            {"080201010073","815"},
            {"080201010074","816"},
            {"080201010075","817"},
            {"080201010076","818"},
            {"080201010077","819"},
            {"080201010078","820"},
            {"080201010079","821"},
            {"08020101007A","822"},
            {"08020101007B","823"},
            {"08020101007C","824"},
            {"0802010100FF","800"},
            {"080202050065","801"},
            {"080202050066","802"},
            {"080202050067","803"},
            {"080202050068","804"},
            {"080202050069","805"},
            {"08020205006A","806"},
            {"08020205006B","807"},
            {"08020205006C","808"},
            {"08020205006D","809"},
            {"08020205006E","810"},
            {"08020205006F","811"},
            {"080202050070","812"},
            {"080202050071","813"},
            {"080202050072","814"},
            {"080202050073","815"},
            {"080202050074","816"},
            {"080202050075","817"},
            {"080202050076","818"},
            {"080202050077","819"},
            {"080202050078","820"},
            {"080202050079","821"},
            {"08020205007A","822"},
            {"08020205007B","823"},
            {"08020205007C","824"},
            {"0802020500FF","800"},
            {"5.0.5","900"},
            {"5.0.6","900"},
            {"5.0.7","900"},
            {"5.0.8","900"},
            {"5.0.9","900"},
            {"5.0.A","900"},
            {"5.0.B","900"},
            {"5.0.C","900"},
            {"5.0.D","900"},
            {"5.1.5","900"},
            {"5.1.6","900"},
            {"5.1.7","900"},
            {"5.1.8","900"},
            {"5.1.9","900"},
            {"5.1.A","900"},
            {"5.1.B","900"},
            {"5.1.C","900"},
            {"5.1.D","900"},
            {"5.2.5","901"},
            {"5.2.6","901"},
            {"5.2.7","901"},
            {"5.2.8","901"},
            {"5.2.9","901"},
            {"5.2.A","901"},
            {"5.2.B","901"},
            {"5.2.C","901"},
            {"5.2.D","901"},
            {"5.3.0","901"},
            {"5.3.5","901"},
            {"5.3.6","901"},
            {"5.3.7","901"},
            {"5.3.8","901"},
            {"5.3.9","901"},
            {"5.3.A","901"},
            {"5.3.B","901"},
            {"5.3.C","901"},
            {"5.3.D","901"},
            {"5.4.5","902"},
            {"5.4.6","902"},
            {"5.4.7","902"},
            {"5.4.8","902"},
            {"5.4.9","902"},
            {"5.4.A","902"},
            {"5.4.B","902"},
            {"5.4.C","902"},
            {"5.4.D","902"},
            {"5.5.0","902"},
            {"5.5.5","902"},
            {"5.5.6","902"},
            {"5.5.7","902"},
            {"5.5.8","902"},
            {"5.5.9","902"},
            {"5.5.A","902"},
            {"5.5.B","902"},
            {"5.5.C","902"},
            {"5.5.D","902"},
            {"5.6.5","903"},
            {"5.6.6","903"},
            {"5.6.7","903"},
            {"5.6.8","903"},
            {"5.6.9","903"},
            {"5.6.A","903"},
            {"5.6.B","903"},
            {"5.6.C","903"},
            {"5.6.D","903"},
            {"5.7.0","903"},
            {"5.7.5","903"},
            {"5.7.6","903"},
            {"5.7.7","903"},
            {"5.7.8","903"},
            {"5.7.9","903"},
            {"5.7.A","903"},
            {"5.7.B","903"},
            {"5.7.C","903"},
            {"5.7.D","903"},
            {"5.8.5","904"},
            {"5.8.6","904"},
            {"5.8.7","904"},
            {"5.8.8","904"},
            {"5.8.9","904"},
            {"5.8.A","904"},
            {"5.8.B","904"},
            {"5.8.C","904"},
            {"5.8.D","904"},
            {"5.9.0","904"},
            {"5.9.5","904"},
            {"5.9.6","904"},
            {"5.9.7","904"},
            {"5.9.8","904"},
            {"5.9.9","904"},
            {"5.9.A","904"},
            {"5.9.B","904"},
            {"5.9.C","904"},
            {"5.9.D","904"},
            {"5.A.5","905"},
            {"5.A.6","905"},
            {"5.A.7","905"},
            {"5.A.8","905"},
            {"5.A.9","905"},
            {"5.A.A","905"},
            {"5.A.B","905"},
            {"5.A.C","905"},
            {"5.A.D","905"},
            {"5.B.0","905"},
            {"5.B.5","905"},
            {"5.B.6","905"},
            {"5.B.7","905"},
            {"5.B.8","905"},
            {"5.B.9","905"},
            {"5.B.A","905"},
            {"5.B.B","905"},
            {"5.B.C","905"},
            {"5.B.D","905"},
            {"5.C.5","906"},
            {"5.C.6","906"},
            {"5.C.7","906"},
            {"5.C.8","906"},
            {"5.C.9","906"},
            {"5.C.A","906"},
            {"5.C.B","906"},
            {"5.C.C","906"},
            {"5.C.D","906"},
            {"5.D.0","906"},
            {"5.D.5","906"},
            {"5.D.6","906"},
            {"5.D.7","906"},
            {"5.D.8","906"},
            {"5.D.9","906"},
            {"5.D.A","906"},
            {"5.D.B","906"},
            {"5.D.C","906"},
            {"5.D.D","906"},
            {"8.2.9","901"},
            {"8.2.A","901"},
            {"8.2.B","901"},
            {"8.2.C","901"},
            {"8.2.D","901"},
            {"8.3.9","902"},
            {"8.3.A","902"},
            {"8.3.B","902"},
            {"8.3.C","902"},
            {"8.3.D","902"},
            {"8.4.9","903"},
            {"8.4.A","903"},
            {"8.4.B","903"},
            {"8.4.C","903"},
            {"8.4.D","903"},
            {"8.5.9","904"},
            {"8.5.A","904"},
            {"8.5.B","904"},
            {"8.5.C","904"},
            {"8.5.D","904"},
            {"8.6.9","905"},
            {"8.6.A","905"},
            {"8.6.B","905"},
            {"8.6.C","905"},
            {"8.6.D","905"},
            {"8.7.9","906"},
            {"8.7.A","906"},
            {"8.7.B","906"},
            {"8.7.C","906"},
            {"8.7.D","906"},
            {"A.0.1","500"}
            #endregion fixed_OBIS
        };

        static string getFixedCode(string code)
        {
            for (int i = 0; i < fixed_OBIS.Length / 2; i++)
            {
                if (fixed_OBIS[i, 0].Equals(code))
                    return fixed_OBIS[i, 1];
            }
            return "";
        }

        public static OBISObject getStandardOBIS(string _207_obis, string value)
        {
            if (value.Contains("NotFound") || value.Contains("Reserved"))
                return null;

            for (int i = 0; i < OBISMappingList.Length / 3; i++)
            {
                if (OBISMappingList[i, 1].Equals(_207_obis))
                {
                    OBISObject ob = new OBISObject();
                    ob.code = OBISMappingList[i, 0].ToString();

                    ob.fixedCode = getFixedCode(ob.code);
                    string var = ConvertToStandardValue(OBISMappingList[i, 2].ToString(), value);

                    if (var == null)
                    {
                        //    System.IO.StreamWriter sw = System.IO.File.AppendText(@"C:\Data.txt");
                        //    sw.WriteLine( HandHeldReader.fileName + "   _207_obis " + _207_obis + " Value " + value  );
                        //    sw.Close();
                        return null;
                    }
                    ob.value = var;
                    //if(ob.code )
                    return ob;
                }
            }
            return null;
        }

        static string ConvertToStandardValue(string convertRule, string value)
        {
            try
            {
                double d = 0;
                switch (convertRule)
                {
                    case "1":
                        value = value.Replace("m3", "");
                        value = value.Replace("/", ".");
                        return value;
                    //d = double.Parse(value);                        
                    //return (d * 1000).ToString();

                    case "2":
                        value = value.Replace("kW", "");
                        value = value.Replace("/", ".");
                        return value;
                    //d = double.Parse(value);
                    //return (d * 1000).ToString();

                    case "3":
                        value = value.Replace("lit/s", "");
                        value = value.Replace("/", ".");
                        return value;
                    //d = double.Parse(value);
                    //return (d * 1000).ToString();

                    case "4":
                        value = value.Replace("h", "");
                        value = value.Replace("/", ".");
                        return value;
                    //d = double.Parse(value);
                    //return (d * 3600).ToString();

                    case "5":
                        value = value.Replace("kvarh", "");
                        value = value.Replace("kVARh", "");
                        value = value.Replace("kvar", "");
                        value = value.Replace("/", ".");
                        return value;
                    //d = double.Parse(value);
                    //return (d * 1000).ToString();

                    case "6":
                        value = value.Replace("kWh", "");
                        value = value.Replace("kW", "");


                        value = value.Replace("/", ".");
                        return value;
                    //d = double.Parse(value);
                    //return (d * 1000).ToString();

                    case "8":

                        #region Convert To Georgian DateTime

                        try
                        {

                            char ch = '/';
                            string[] dateParam = value.Split(ch);

                            int year = 1300;
                            int day = 0, month = 0;

                            int.TryParse(dateParam[0], out year);
                            int.TryParse(dateParam[1], out month);
                            int.TryParse(dateParam[2], out day);

                            if (year > 50)
                                year += 1300;
                            else
                                year += 1400;

                            
                            PersianDate pd= new PersianDate(year, month, day, 0, 0, 0);

                            // if (pd.Compare(PersianDate.Now, pd) > 0)
                            value =pd.ConvertToGeorgianDateTime().ToString();
                            // else
                            //   Value = new DateTime(1921,3,21,0,0,0).ToString();
                        }
                        catch
                        {
                            value = new DateTime(1921,3,21,0,0,0).ToString();
                        }
                        return value;

                    #endregion Convert To Georgian DateTime


                    case "9": // Conver To Hour.Minutes
                         value = value.Replace("h", "");
                        value = value.Replace("/", ".");
                        ulong ul = (ulong)(Convert.ToDecimal(value) * 60);
                        value = (ul / 60) + "." + (ul % 60).ToString().PadLeft(2,'0');
                        return value;

                    default:
                        break;
                }
                switch (value)
                {
                    case "880130": value = "207.5"; break;
                    case "880205": value=  "207.5"; break;
                    case "880205D": value = "207.5"; break;
                    case "8901231720I5.": value =   "207.5"; break;
                    case "8901231720D5":  value =   "207.5"; break;
                    case "8901231720D5.": value = "207.5.5"; break;                        
                    case "8901231720I5": value = "207.5"; break;
                    case "8907101350I5": value = "207.5.6"; break;
                    case "8907101350I5.": value = "207.5.6"; break;
                        
                    case "9006211241D7": value =   "207.7.2"; break;
                    case "9006211241I7": value =   "207.7.2"; break;
                    case "9104281105D7": value =   "207.7.3"; break;
                    case "9105251241D7": value =   "207.7.3"; break;
                    case "9109211400DO": value = "207.7.3"; break;
                    case "13871214": value = "207.4"; break;                   
                       
                    default:
                        break;
                }
                return value;
            }
            catch
                (Exception)
            {
                return null;
            }
        }
    }
}